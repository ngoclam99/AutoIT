<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
    <head>
        <title>_WinHttpSimpleBinaryConcat</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=9">
        <link href="../CSS/Default1.css" rel="stylesheet" type="text/css">
        <script type="text/javascript" src="../JScript/Script_Right.js" charset="utf-8"></script>
    </head>

    <body>

<!--Description Section-->
        <h1 class="small">Function Reference</h1>
        <hr style="height:0px">
        <h1>_WinHttpSimpleBinaryConcat</h1>
        <p class="funcdesc">Concatenates two binary data returned by _WinHttpReadData() in binary mode.<br></p>

<!--Syntax Section-->
        <h2>Syntax</h2>
        <p>        <p class="codeheader">
        #include "WinHttp.au3"<br>
        _WinHttpSimpleBinaryConcat(ByRef $bBinary1, ByRef $bBinary2)<br>
        </p>

<!--Parameters Section-->
        <h2>Parameters</h2>
        <table class="paramstable">
            <tr>
                <td class="leftpane">$bBinary1</td>
                <td class="rightpane">Binary data that is to be concatenated.</td>
            </tr>
            <tr>
                <td class="leftpane">$bBinary2</td>
                <td class="rightpane">Binary data to concatenate.</td>
            </tr>
        </table>

<!--Return Value Section-->
        <h2>Return Value</h2>
        <p>Success - Returns concatenated binary data.<br>
        Failure - Returns empty binary and sets @error:<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 - Invalid input.</p>

<!--Remarks Section-->
<!--Related Section-->
        <h2>Related</h2><a onclick='UpdateLocation("_WinHttpReadData")' href="_WinHttpReadData.htm">_WinHttpReadData</a>
        <br>

<!--Link Section-->
<!--Example Section-->
        <h2>Example</h2>
<a class="button" onmouseover="Btn_OnMouseOver(this)" onmouseout='Btn_OnMouseOut(this, "divtip")' onclick='BTN_OnClick("au3code", "divtip")'>Copy to clipboard</a><p class="codebox" id="au3code"><br> 
<br><br><span class="S11">#include<span class="S7">&nbsp;"WinHttp.au3"</span></span><br><br>
<span class="S4">Opt</span><span class="S8">(</span><span class="S7">"MustDeclareVars"</span><span class="S8">,</span><span class="S3">&nbsp;1</span><span class="S8">)</span><br><br>
Global<span class="S9">&nbsp;$sHost</span><span class="S8">&nbsp;=</span><span class="S7">&nbsp;"images.fanpop.com"</span><br>
Global<span class="S9">&nbsp;$sTarget</span><span class="S8">&nbsp;=</span><span class="S7">&nbsp;"images/image_uploads/Hello-Kitty-hello-kitty-181509_1024_768.jpg"</span><br>
Global<span class="S9">&nbsp;$sDestination</span><span class="S8">&nbsp;=</span><span class="S6">&nbsp;@ScriptDir</span><span class="S8">&nbsp;&amp;</span><span class="S7">&nbsp;"\HelloKitty.jpg"</span><br><br>
<span class="S2">; Initialize and get session handle</span><br>
Global<span class="S9">&nbsp;$hHttpOpen</span><span class="S8">&nbsp;=</span><span class="S15">&nbsp;_WinHttpOpen</span><span class="S8">(</span><span class="S8">)</span><br>
If<span class="S6">&nbsp;@error</span><span class="S5">&nbsp;Then</span><br>
<span class="S4">&nbsp;&nbsp;&nbsp;&nbsp;MsgBox</span><span class="S8">(</span><span class="S3">48</span><span class="S8">,</span><span class="S7">&nbsp;"Error"</span><span class="S8">,</span><span class="S7">&nbsp;"Error initializing the usage of WinHTTP functions."</span><span class="S8">)</span><br>
<span class="S5">&nbsp;&nbsp;&nbsp;&nbsp;Exit</span><span class="S3">&nbsp;1</span><br>
EndIf<br><span class="S2">; Get connection handle</span><br>
Global<span class="S9">&nbsp;$hHttpConnect</span><span class="S8">&nbsp;=</span><span class="S15">&nbsp;_WinHttpConnect</span><span class="S8">(</span><span class="S9">$hHttpOpen</span><span class="S8">,</span><span class="S9">&nbsp;$sHost</span><span class="S8">)</span><br>
If<span class="S6">&nbsp;@error</span><span class="S5">&nbsp;Then</span><br>
<span class="S4">&nbsp;&nbsp;&nbsp;&nbsp;MsgBox</span><span class="S8">(</span><span class="S3">48</span><span class="S8">,</span><span class="S7">&nbsp;"Error"</span><span class="S8">,</span><span class="S7">&nbsp;"Error specifying the initial target server of an HTTP request."</span><span class="S8">)</span><br>
<span class="S15">&nbsp;&nbsp;&nbsp;&nbsp;_WinHttpCloseHandle</span><span class="S8">(</span><span class="S9">$hHttpOpen</span><span class="S8">)</span><br>
<span class="S5">&nbsp;&nbsp;&nbsp;&nbsp;Exit</span><span class="S3">&nbsp;2</span><br>
EndIf<br><span class="S2">; Specify the reguest</span><br>
Global<span class="S9">&nbsp;$hHttpRequest</span><span class="S8">&nbsp;=</span><span class="S15">&nbsp;_WinHttpOpenRequest</span><span class="S8">(</span><span class="S9">$hHttpConnect</span><span class="S8">,</span><span class="S5">&nbsp;Default</span><span class="S8">,</span><span class="S9">&nbsp;$sTarget</span><span class="S8">)</span><br>
If<span class="S6">&nbsp;@error</span><span class="S5">&nbsp;Then</span><br>
<span class="S4">&nbsp;&nbsp;&nbsp;&nbsp;MsgBox</span><span class="S8">(</span><span class="S3">48</span><span class="S8">,</span><span class="S7">&nbsp;"Error"</span><span class="S8">,</span><span class="S7">&nbsp;"Error creating an HTTP request handle."</span><span class="S8">)</span><br>
<span class="S15">&nbsp;&nbsp;&nbsp;&nbsp;_WinHttpCloseHandle</span><span class="S8">(</span><span class="S9">$hHttpConnect</span><span class="S8">)</span><br>
<span class="S15">&nbsp;&nbsp;&nbsp;&nbsp;_WinHttpCloseHandle</span><span class="S8">(</span><span class="S9">$hHttpOpen</span><span class="S8">)</span><br>
<span class="S5">&nbsp;&nbsp;&nbsp;&nbsp;Exit</span><span class="S3">&nbsp;3</span><br>
EndIf<br><span class="S2">; Send request</span><br>
<span class="S15">_WinHttpSendRequest</span><span class="S8">(</span><span class="S9">$hHttpRequest</span><span class="S8">)</span><br>
If<span class="S6">&nbsp;@error</span><span class="S5">&nbsp;Then</span><br>
<span class="S4">&nbsp;&nbsp;&nbsp;&nbsp;MsgBox</span><span class="S8">(</span><span class="S3">48</span><span class="S8">,</span><span class="S7">&nbsp;"Error"</span><span class="S8">,</span><span class="S7">&nbsp;"Error sending specified request."</span><span class="S8">)</span><br>
<span class="S15">&nbsp;&nbsp;&nbsp;&nbsp;_WinHttpCloseHandle</span><span class="S8">(</span><span class="S9">$hHttpConnect</span><span class="S8">)</span><br>
<span class="S15">&nbsp;&nbsp;&nbsp;&nbsp;_WinHttpCloseHandle</span><span class="S8">(</span><span class="S9">$hHttpOpen</span><span class="S8">)</span><br>
<span class="S5">&nbsp;&nbsp;&nbsp;&nbsp;Exit</span><span class="S3">&nbsp;4</span><br>
EndIf<br><br><span class="S2">; Wait for the response</span><br>
<span class="S15">_WinHttpReceiveResponse</span><span class="S8">(</span><span class="S9">$hHttpRequest</span><span class="S8">)</span><br>
<span class="S2">; Read if available</span><br>
Global<span class="S9">&nbsp;$bChunk</span><span class="S8">,</span><span class="S9">&nbsp;$bData</span><span class="S8">,</span><span class="S9">&nbsp;$hFile</span><br>
If<span class="S15">&nbsp;_WinHttpQueryDataAvailable</span><span class="S8">(</span><span class="S9">$hHttpRequest</span><span class="S8">)</span><span class="S5">&nbsp;Then</span><br>
<span class="S5">&nbsp;&nbsp;&nbsp;&nbsp;While</span><span class="S3">&nbsp;1</span><br>
<span class="S9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bChunk</span><span class="S8">&nbsp;=</span><span class="S15">&nbsp;_WinHttpReadData</span><span class="S8">(</span><span class="S9">$hHttpRequest</span><span class="S8">,</span><span class="S3">&nbsp;2</span><span class="S8">)</span><span class="S2">&nbsp;; read binary</span><br>
<span class="S5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If</span><span class="S6">&nbsp;@error</span><span class="S5">&nbsp;Then</span><span class="S5">&nbsp;ExitLoop</span><br>
<span class="S9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bData</span><span class="S8">&nbsp;=</span><span class="S15">&nbsp;_WinHttpSimpleBinaryConcat</span><span class="S8">(</span><span class="S9">$bData</span><span class="S8">,</span><span class="S9">&nbsp;$bChunk</span><span class="S8">)</span><span class="S2">&nbsp;; concat two binary data</span><br>
<span class="S5">&nbsp;&nbsp;&nbsp;&nbsp;WEnd</span><br>
<span class="S2">&nbsp;&nbsp;&nbsp;&nbsp;; Save it to the file</span><br>
<span class="S9">&nbsp;&nbsp;&nbsp;&nbsp;$hFile</span><span class="S8">&nbsp;=</span><span class="S4">&nbsp;FileOpen</span><span class="S8">(</span><span class="S9">$sDestination</span><span class="S8">,</span><span class="S3">&nbsp;26</span><span class="S8">)</span><br>
<span class="S4">&nbsp;&nbsp;&nbsp;&nbsp;FileWrite</span><span class="S8">(</span><span class="S9">$hFile</span><span class="S8">,</span><span class="S9">&nbsp;$bData</span><span class="S8">)</span><br>
<span class="S4">&nbsp;&nbsp;&nbsp;&nbsp;FileClose</span><span class="S8">(</span><span class="S9">$hFile</span><span class="S8">)</span><br>
Else<br><span class="S4">&nbsp;&nbsp;&nbsp;&nbsp;MsgBox</span><span class="S8">(</span><span class="S3">48</span><span class="S8">,</span><span class="S7">&nbsp;"Error occurred"</span><span class="S8">,</span><span class="S7">&nbsp;"No data available. "</span><span class="S8">&nbsp;&amp;</span><span class="S6">&nbsp;@CRLF</span><span class="S8">)</span><br>
EndIf<br><br><span class="S2">; Close handles</span><br>
<span class="S15">_WinHttpCloseHandle</span><span class="S8">(</span><span class="S9">$hHttpRequest</span><span class="S8">)</span><br>
<span class="S15">_WinHttpCloseHandle</span><span class="S8">(</span><span class="S9">$hHttpConnect</span><span class="S8">)</span><br>
<span class="S15">_WinHttpCloseHandle</span><span class="S8">(</span><span class="S9">$hHttpOpen</span><span class="S8">)</span><br><br>
<span class="S2">; See what's downloaded</span><br>
<span class="S4">ShellExecute</span><span class="S8">(</span><span class="S9">$sDestination</span><span class="S8">)</span><br><br>
</p><br>
        <div id="divtip" name="divtip" class="tip"></div>

    </body>
</html>
